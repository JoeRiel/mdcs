#!/bin/bash

# Simple installation script for mdcs

LISP_BASE=$HOME/.emacs.d           # location of maplev.el[c]
LISP_DIR=$LISP_BASE/mds            # place to install mds lisp files
INFO_DIR=$HOME/share/info          # for the info file
MAPLE_INSTALL_DIR=$HOME/maple/lib  # for the Maple archive and help database

echo "Byte-compiling mds lisp files"
# Byte-compile lisp/*.el
emacs --no-site-file \
      --no-init-file \
      --eval "(push (expand-file-name \"./lisp\") load-path)" \
      --eval "(push \"$LISP_BASE\" load-path)" \
      --batch \
      --funcall=batch-byte-compile \
      lisp/*.el

CP="cp --preserve --verbose"
MKDIR="mkdir --parent"
RM="rm --force --verbose"

# remove old mds stuff; now in mds subdirectory
$RM $LISP_DIR/mds*.el $LISP_DIR/mds*.elc

echo -e "\nInstalling lisp files"
$MKDIR $LISP_DIR
$CP lisp/*.el lisp/*.elc $LISP_DIR
echo -e "\nInstalling info files"
$CP doc/mds $INFO_DIR
echo -e "\nInstalling Maple files"
$CP mdc.mla mdc.hdb $MAPLE_INSTALL_DIR
echo -e "\nDone"
echo
echo "Update, if needed, your .emacs file.  See README for details."
exit 0
